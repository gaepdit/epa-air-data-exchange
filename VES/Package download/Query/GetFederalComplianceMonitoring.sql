SELECT C.ComplianceMonitoringId,C.ProgramSystemAcronym,C.ProgramSystemIdentifier,C.FederalStatuteCode,C.ActivityTypeCode,C.CategoryCode,C.ComplianceMonitoringDate,C.StartDate,C.InspectionTypeCode,C.ActivityName,C.ActionReasonCode,C.AgencyTypeCode,C.AgencyCode,C.ProgramCode,C.EPAAssistanceIndicator,C.StateFederalJointIndicator,C.JointInspectionReasonCode,C.LeadParty,C.Days,C.Hours,C.ActionOutcomeCode,C.InspectionRatingCode,C.NationalPrioritiesCode,C.MultimediaIndicator,C.FederalFacilityIndicator,C.FederalFacilityIndicatorComment,C.InspectionUserDefinedField1,C.InspectionUserDefinedField2,C.InspectionUserDefinedField3,C.InspectionUserDefinedField4,C.InspectionUserDefinedField5,C.InspectionUserDefinedField6,C.PlannedStartDate,C.PlannedEndDate,C.EPARegion,C.LawSectionCode,C.MediaTypeCode,C.RegionalPriorityCode, SIC.SICCode, NAICS.NAICSCode, C.LeadAgencyCode,C.InspectionCommentText,C.SensitiveCommentText,C.TransactionID,C.OtherProgramDescriptionText, AirStackTestData.StackTestStatusCode, AirStackTestData.ConductorTypeCode, AirStackTestData.StackIdentifier,AirStackTestData.StackTestPurposeCode,AirStackTestData.OtherStackTestPurposeName,AirStackTestData.ObservedAgencyTypeCode,AirStackTestData.ReportReceivedDate,AirStackTestData.ResultsReviewedDate,TestResultsData.TestResultsDataId, TestResultsData.AirTestedPollutantCode, TestResultsData.MethodCode,TestResultsData.TestResultCode,ComplianceMonitoringContact.ContactId,Contact.AffiliationTypeText,Contact.FirstName,Contact.MiddleName,Contact.LastName, Contact.IndividualTitleText,Contact.OrganizationFormalName,Contact.StateCode,Telephone.TelephoneID,Telephone.TelephoneNumberTypeCode,Telephone.TelephoneNumber,Telephone.TelephoneExtensionNumber,InspectionGovernmentContact.ContactId AS GContactId,GContact.AffiliationTypeText AS GAffiliationTypeText,GContact.ElectronicAddressText AS GElectronicAddressText,[Transaction].TransactionType,CONVERT(VARCHAR(30),[Transaction].TransactionTimestamp, 126) as TransactionTimestamp FROM ComplianceMonitoring C LEFT JOIN SIC ON SIC.ComplianceMonitoringId = C.ComplianceMonitoringId LEFT JOIN NAICS ON NAICS.ComplianceMonitoringId = C.ComplianceMonitoringId LEFT JOIN AirStackTestData ON C.ComplianceMonitoringId = AirStackTestData.ComplianceMonitoringId LEFT JOIN TestResultsData ON C.ComplianceMonitoringId = TestResultsData.ComplianceMonitoringId LEFT JOIN ComplianceMonitoringContact ON C.ComplianceMonitoringId = ComplianceMonitoringContact.ComplianceMonitoringId LEFT JOIN Contact ON ComplianceMonitoringContact.ContactId = Contact.ContactID LEFT JOIN Telephone ON Contact.ContactID = Telephone.ContactID LEFT JOIN InspectionGovernmentContact ON C.ComplianceMonitoringId = InspectionGovernmentContact.ComplianceMonitoringId LEFT JOIN Contact GContact ON InspectionGovernmentContact.ContactId = GContact.ContactID INNER JOIN [Transaction] ON C.TransactionID = [Transaction].TransactionID INNER JOIN SubmissionStatus ON C.ComplianceMonitoringId = SubmissionStatus.ID WHERE C.MonitoringType='Federal' AND  SubmissionStatus.TableName='ComplianceMonitoring' AND SubmissionStatus.Status is NULL AND SubmissionStatus.Operation <> 'delete' AND SubmissionStatus.ID in ('{$ComplianceMonitoringID}') AND [Transaction].TransactionTimestamp between '{$fromDate}' and '{$toDate}'